import ctypes

# The target array from the .rodata
target = [0x33, 0x84, 0x3D, 0x3F, 0x2A, 0x93, 0x7B, 0x82, 0x1A, 0xAC, 0x8E, 0xF4, 0xB1, 0xCB, 0x8D, 0x21, 0xE, 0xB7, 0x67, 0x96, 0x2C, 0x81, 0xD3, 0xBC, 0x29, 0x6C, 0x4B, 0xD, 0x0, 0xED, 0xFD, 0xEE, 0x56, 0x40, 0x52, 0xD5, 0x5, 0x6D, 0x90, 0x3E, 0x7A, 0x1B, 0x69, 0x23, 0x1F, 0xB6, 0x1D, 0xBC, 0x98, 0xD1, 0xA6, 0x83, 0xE9, 0xEB, 0x13, 0x21, 0x3D, 0xF8, 0x2B, 0x79, 0x53, 0x4F, 0xA1]

# The libc rand() function
libc = ctypes.CDLL('libc.so.6')
rand = libc.rand
rand.argtypes = []
rand.restype = ctypes.c_int

# The libc srand() function
srand = libc.srand
srand.argtypes = [ctypes.c_uint]
srand.restype = None

# Brute force the seed
for seed in range(2**32):
    srand(seed)
    flag = []
    for i in range(len(target)):
        r = rand() % 0x100
        flag.append(chr(target[i] ^ r))
    if flag[0] == 'T' and flag[1] == 'B' and flag[2] == 'T' and flag[3] == 'L':
        print(''.join(flag))
        break
